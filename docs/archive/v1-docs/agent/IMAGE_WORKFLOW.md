# 画像取得ワークフロー

作成日: 2025年1月

## 📋 画像取得の新しいワークフロー

### 基本方針

**画像取得はユーザーの指示に基づいて実行します。**

1. **ユーザーが画像取得を指示**
   - Chatで「○○温泉の画像を取得して」などと指示

2. **エージェントが画像を取得**
   - `scripts/fetch-onsen-images-multi-api.js`を実行
   - 取得した画像のURLをChatに表示

3. **ユーザーが画像を確認**
   - Chatに表示された画像リンクを確認
   - 画像の品質・適切性を判断

4. **ユーザーが判断**
   - **OK**: 「この画像を使用して」→ エージェントが`data/wikimedia-images.json`に追加
   - **NG**: 「再取得して」または「この画像を使用して」（ユーザーがChatに画像をアップロード）

5. **エージェントがサイトに反映**
   - 承認された画像を`data/wikimedia-images.json`に追加
   - `content.json`の`image`フィールドにキーを設定（必要に応じて）

## 🔄 ワークフローの詳細

### ステップ1: 画像取得の指示

ユーザーがChatで指示:
```
「箱根温泉の画像を取得して」
「草津温泉の画像を再取得して」
```

### ステップ2: 画像取得の実行

エージェントが実行:
```bash
node scripts/fetch-onsen-images-multi-api.js
```

### ステップ3: 取得結果の報告

エージェントがChatに報告:
```
取得した画像:
- 箱根温泉: https://upload.wikimedia.org/...
- 品質評価: 高品質、露天風呂が明確に写っている
```

### ステップ4: ユーザーの判断

ユーザーが判断:
- **OK**: 「この画像を使用して」
- **NG**: 「再取得して」または画像をChatにアップロード

### ステップ5: サイトへの反映

エージェントが実行:
1. `data/wikimedia-images.json`に画像を追加
2. `content.json`の`image`フィールドを確認・設定
3. サイトで画像が表示されることを確認

## ⚠️ 重要な注意事項

### エージェント向け

- **画像を自動的に取得しない**
- **ユーザーの指示がある場合のみ画像を取得**
- **取得した画像は必ずChatにリンクを表示**
- **ユーザーの承認を得てからサイトに反映**

### ユーザー向け

- 画像取得はChatで指示してください
- 取得した画像のリンクを確認してください
- OK/NGを明確に伝えてください
- NGの場合は再取得を依頼するか、画像をChatにアップロードしてください

## 📝 画像の確認方法

### 取得した画像のURLを確認

エージェントがChatに表示する形式:
```
取得した画像:
- [温泉名]: [URL]
- 品質評価: [評価]
- ライセンス: [ライセンス情報]
```

### 画像を直接確認

1. Chatに表示されたURLをクリック
2. 画像の品質・適切性を確認
3. OK/NGを判断

## 🔧 トラブルシューティング

### 画像が取得できない場合

- 検索キーワードを変更して再取得
- 別のAPIを試す（Pixabay、Pexels、Unsplash）
- ユーザーに画像をChatにアップロードしてもらう

### 画像の品質が低い場合

- 再取得を依頼
- 検索条件を調整
- ユーザーに画像をChatにアップロードしてもらう

## 📚 関連ドキュメント

- [`../images/IMAGE_MANAGEMENT_SYSTEM.md`](../images/IMAGE_MANAGEMENT_SYSTEM.md) - 画像管理システムの仕組み
- [`../images/MULTI_API_IMAGE_FETCH.md`](../images/MULTI_API_IMAGE_FETCH.md) - 画像取得システムの使い方
- [`AGENT_GUIDE.md`](./AGENT_GUIDE.md) - エージェント向けガイド
