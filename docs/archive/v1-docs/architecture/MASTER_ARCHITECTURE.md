# マスターアーキテクチャ設計書

## 🎯 設計原則

1. **単一の情報源**: `themes/onsen-kanto/content.json`が唯一のコンテンツソース
2. **明確な依存関係**: すべてのファイルの依存関係を明確化
3. **JSON-first**: すべてのコンテンツはJSONから制御される
4. **型安全性**: TypeScriptの型定義により、JSONスキーマを保証

## 📁 ディレクトリ構成

```
/
├── app/                          # Next.js App Router
│   ├── components/              # 再利用可能なコンポーネント
│   │   ├── navigation/         # ナビゲーション関連
│   │   │   └── Header.tsx     # ヘッダーコンポーネント（重要）
│   │   ├── home/               # ホームページ用コンポーネント
│   │   ├── ui/                 # UIコンポーネント
│   │   └── icons/              # アイコンコンポーネント
│   ├── lib/                     # ユーティリティ関数
│   │   └── content.ts          # コンテンツ読み込みロジック（重要）
│   ├── page.tsx                 # トップページ
│   ├── layout.tsx               # ルートレイアウト（重要）
│   └── [各ページ]/              # 各ページ
├── themes/                      # テーマ設定
│   └── onsen-kanto/            # 関東温泉テーマ
│       └── content.json        # メインコンテンツ（唯一の情報源・最重要）
├── docs/                        # ドキュメント（整理済み）
│   ├── architecture/           # アーキテクチャ設計
│   ├── development/            # 開発ドキュメント
│   └── deployment/             # デプロイ関連
└── public/                      # 静的ファイル
    └── images/                  # 画像ファイル
```

## 🔑 重要なファイル

### 1. `/themes/onsen-kanto/content.json` ⭐最重要
**役割**: サイト全体のコンテンツを定義（唯一の情報源）

**編集方法**:
- このファイルを編集するだけで、サイト全体のコンテンツが変更されます
- ナビゲーション、ページ内容、画像URLなど、すべてここで管理

**構造**:
```json
{
  "site": { ... },           // サイト基本情報
  "navigation": [ ... ],      // ナビゲーションメニュー
  "pages": {
    "home": { ... },         // トップページ
    "docs": [ ... ],         // ドキュメントページ
    "blog": { ... },         // ブログページ
    "features": { ... },     // フィーチャーページ
    "contact": { ... }       // お問い合わせページ
  }
}
```

### 2. `/app/lib/content.ts` ⭐重要
**役割**: コンテンツ読み込みロジック

**機能**:
- `loadContent()`: メインコンテンツを読み込む
- `getDocPage()`: 特定のドキュメントページを取得
- `getAllDocSlugs()`: すべてのドキュメントスラッグを取得
- `getBlogPost()`: 特定のブログ投稿を取得
- `getAllBlogSlugs()`: すべてのブログスラッグを取得

**読み込み元**: `themes/onsen-kanto/content.json`

### 3. `/app/layout.tsx` ⭐重要
**役割**: ルートレイアウト（全ページ共通）

**機能**:
- `loadContent()`を呼び出してコンテンツを取得
- Headerコンポーネントにデータを渡す
- メタデータを動的に生成

### 4. `/app/components/navigation/Header.tsx` ⭐重要
**役割**: ヘッダーコンポーネント（ナビゲーション）

**機能**:
- ロゴの表示（JSONから取得）
- ナビゲーションメニューの表示（JSONから取得）
- ハンバーガーメニュー（モバイル）
- スクロール時のスタイル変更

## 🔄 データフロー

```
1. ユーザーがページにアクセス
   ↓
2. Next.jsが該当するページコンポーネントを読み込む
   ↓
3. ページコンポーネントが loadContent() を呼び出し
   ↓
4. app/lib/content.ts が themes/onsen-kanto/content.json を読み込む
   ↓
5. データがページコンポーネントに返される
   ↓
6. ページコンポーネントがデータを各セクションコンポーネントに渡す
   ↓
7. セクションコンポーネントがデータを表示
```

## 📝 編集ガイド

### コンテンツ編集者（非エンジニア）向け

**編集するファイル**: `/themes/onsen-kanto/content.json`

**編集可能な項目**:
- サイト名、ロゴ、メタデータ
- ナビゲーションメニュー
- 各ページのコンテンツ
- 画像URL
- テキスト内容

**編集方法**: JSONファイルを編集するだけ

### 開発者向け

**見るべきファイル**:
- `/docs/architecture/MASTER_ARCHITECTURE.md` - このファイル
- `/app/lib/content.ts` - コンテンツ読み込みロジック
- `/app/components/navigation/Header.tsx` - ヘッダーコンポーネント

**コードを変更する場合**:
- コンポーネントの追加・修正: `/app/components/`
- ページの追加・修正: `/app/[ページ名]/`
- コンテンツ読み込みロジックの変更: `/app/lib/content.ts`

## 🚫 使用されていないファイル

- ❌ `config/site.config.ts` - 削除済み
- ⚠️ `app/config/theme.config.ts` - 使用されていないが、将来の拡張のために保持

## ✅ 設計の確認

この設計により、以下のことが保証されます：

1. **明確な情報源**: `content.json`が唯一のコンテンツソース
2. **編集の容易さ**: 非エンジニアでもJSONを編集するだけでコンテンツを変更可能
3. **型安全性**: TypeScriptの型定義により、JSONの構造が保証される
4. **保守性**: ファイル構成が明確で、どこを編集すればよいかが分かる
