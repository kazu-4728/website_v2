# Dependabot管理ガイド

## 現在の設定

### 更新頻度
- **npm依存関係**: 月次（毎月第1月曜日）
- **GitHub Actions**: 月次（毎月第1月曜日）
- **PRの最大数**: 3個まで

### グルーピング戦略
1. **all-dependencies**: マイナー・パッチ更新を全て1つのPRにまとめる
2. **security-updates**: セキュリティ更新のみを別PRで作成（最優先）

### 許可される更新
- **本番依存関係**: セキュリティ、パッチ、マイナー更新
- **直接依存関係**: セキュリティ更新のみ
- **メジャーバージョン更新**: 手動で確認・適用

## 既存のオープンPRの処理方法

### 1. セキュリティ関連PRの確認
```bash
# セキュリティラベルがついたPRを確認
gh pr list --label security
```

### 2. PRの優先度付け
1. **高優先度**: セキュリティ更新（即座にマージ推奨）
2. **中優先度**: 破壊的変更のないマイナー/パッチ更新
3. **低優先度**: メジャーバージョン更新（慎重に検証）

### 3. PRのクローズ
不要なPRをクローズする場合：
```bash
# 特定のPRをクローズ
gh pr close <PR番号> --comment "新しいグルーピング戦略により、このPRはクローズします。次回の月次更新で統合されます。"
```

### 4. PRのマージ
安全なPRをマージする場合：
```bash
# PRをマージ
gh pr merge <PR番号> --squash --auto
```

## 現在のオープンPR分析（2025-12-16時点）

以下のPRが現在オープンです：

1. **PR #33**: React 19.2.3へのアップデート
   - 優先度: 中
   - 対応: レビューしてマージ検討

2. **PR #32**: Browserslist 4.28.1へのアップデート
   - 優先度: 低
   - 対応: 次回の統合PRに含める

3. **PR #30**: Tailwind CSS関連の更新
   - 優先度: 中
   - 対応: レビューしてマージ検討

4. **PR #29**: ESLint/Prettier関連の更新
   - 優先度: 中
   - 対応: レビューしてマージ検討

5. **PR #24**: Framer Motion 12へのメジャー更新
   - 優先度: 低（メジャーバージョン）
   - 対応: 破壊的変更を確認後、慎重にマージ

## 推奨される対応手順

### オプション1: 一括クローズ（推奨）
新しいグルーピング戦略により、次回の月次更新で全ての依存関係が1つのPRにまとめられます。

```bash
# 全てのDependabot PRをクローズ
for pr in 33 32 30 29 24; do
  gh pr close $pr --comment "新しいDependabot設定により、このPRをクローズします。次回の月次更新（2026年1月第1月曜日）で、全ての依存関係が統合されたPRが作成されます。"
done
```

### オプション2: セキュリティPRのみマージ
セキュリティ関連のPRがあれば、それだけマージして残りはクローズ：

```bash
# セキュリティPRを確認
gh pr list --label security --json number,title

# セキュリティPRをマージ（該当する場合）
# gh pr merge <セキュリティPR番号> --squash --auto

# 残りをクローズ
# ... (上記の一括クローズコマンド)
```

### オプション3: 全てマージ（非推奨）
各PRを個別にレビュー・マージする場合（手動対応が必要）

## 今後の運用

### 月次チェックリスト
1. 月初第1月曜日にDependabot PRが作成される
2. PRの内容を確認（特に破壊的変更）
3. テストが通ることを確認
4. 問題なければマージ

### セキュリティ更新
- セキュリティPRは別途作成されるため、即座に対応
- 優先度: 最高

### メジャーバージョン更新
- 自動では作成されない
- 必要に応じて手動で更新
- 破壊的変更を慎重に確認

## トラブルシューティング

### PRが多すぎる場合
1. `open-pull-requests-limit`をさらに削減（現在3）
2. 更新頻度を変更（月次 → 四半期など）
3. より厳しい`allow`ルールを設定

### 重要な更新が遅れる場合
1. セキュリティラベルを確認
2. 手動で`npm update`を実行
3. `open-pull-requests-limit`を一時的に増やす

## 参考リンク
- [Dependabot設定リファレンス](https://docs.github.com/ja/code-security/dependabot/dependabot-version-updates/configuration-options-for-the-dependabot.yml-file)
- [GitHub CLI PRコマンド](https://cli.github.com/manual/gh_pr)
