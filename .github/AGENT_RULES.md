# 🤖 AIエージェント共通ルール

**最終更新**: 2025年12月22日  
**対象**: すべてのAIエージェント（GitHub Copilot、Cursor、その他）  
**優先度**: 🔴 最優先・必読

---

## 🎯 このルールの目的

**すべてのエージェントが同じ基準で作業し、同じ品質を保証する**

---

## 📖 必読ドキュメント（厳守）

### 作業開始前に必ず読むドキュメント

1. **`docs/START_HERE.md`** - プロジェクト概要
2. **`docs/CURRENT_STATE.md`** - 現在の状態（実態ベース）
3. **`docs/REPOSITORY_GUIDE.md`** - リポジトリ構造と作業ルール
4. **`.cursorrules`** - 全エージェント共通の基本ルール（言語要件等）
5. **`.github/copilot-instructions.md`** - GitHub Copilot Agent向け設定

---

## 🇯🇵 言語要件（最優先）

**重要**: このプロジェクトでは、**すべての対応を日本語で行ってください**。

### 必須要件

- **コミットメッセージ**: 日本語で記載
- **PR説明文**: 日本語で記載
- **コメント**: 日本語で記載
- **レポート**: 日本語で記載
- **エラーメッセージの説明**: 日本語で記載
- **ドキュメント**: 日本語で記載

### 例外

- コード内のコメント: 英語でも可
- 変数名・関数名: 英語
- コミットメッセージのプレフィックス: 英語可（`fix:`, `feat:` 等）

---

## 📋 タスク定義ルール

### タスク定義テンプレート（必須使用）

```markdown
## タスク: [具体的な機能名]

**目的**: [何を達成するか]

**完了条件**:
- [ ] レベル1: コード作成
  - [ ] ファイル作成
  - [ ] 構文チェック（ESLint）
  - [ ] 型チェック（TypeScript）
- [ ] レベル2: 統合
  - [ ] ページファイルへのインポート
  - [ ] 既存コンポーネントの置き換え
  - [ ] ビルド成功（`npm run build`）
- [ ] レベル3: 動作確認（**必須**）
  - [ ] ローカル起動（`npm run dev`）
  - [ ] ブラウザで表示確認
  - [ ] スクリーンショット撮影・添付
  - [ ] 期待通りの表示を確認
- [ ] レベル4: デプロイ
  - [ ] 静的エクスポート成功
  - [ ] GitHub Pages デプロイ確認

**根拠**:
- コミット: [コミット後に記入]
- スクリーンショット: [添付先URL]
- 確認日時: [YYYY-MM-DD HH:MM UTC]

**進捗**: [未着手 / 進行中 / 完了]
```

### タスク定義の悪い例・良い例

**❌ 悪い例**:
```markdown
- [ ] ホームページを更新
```
→ 何をするのか不明確、完了条件がない

**✅ 良い例**:
```markdown
## タスク: ホームページのHeroセクションをOceanViewHeroに置き換え

**目的**: ユーザーが見るホームページのHeroを新デザインにする

**完了条件**:
- [ ] レベル1: OceanViewHero コンポーネント確認
- [ ] レベル2: app/page.tsx へのインポートと置き換え、ビルド成功
- [ ] レベル3: ローカル確認、スクリーンショット添付
- [ ] レベル4: デプロイ確認

**根拠**:
- コミット: a1b2c3d
- スクリーンショット: ./screenshots/hero-replaced-20251222.png
- 確認日時: 2025-12-22 15:00 UTC

**進捗**: 完了
```

---

## ✅ 「完了」の定義（厳守）

### 完了の4段階

| レベル | 内容 | 完了扱い |
|--------|------|---------|
| レベル1 | ファイル作成、構文・型チェック | ❌ 未完了 |
| レベル2 | インポート、統合、ビルド成功 | ❌ 未完了 |
| レベル3 | ローカル確認、スクリーンショット | ✅ **完了** |
| レベル4 | デプロイ確認 | ✅ 完了（推奨） |

### 重要な原則

1. **ファイル作成 ≠ 完了**
2. **ビルド成功 ≠ 完了**
3. **ドキュメントにチェック ≠ 完了**
4. **ブラウザで確認して初めて完了**

---

## 📸 スクリーンショット要件

### 必須ケース

視覚的な変更を伴うタスクは、**スクリーンショット必須**

### スクリーンショットの撮り方

1. **Before/After 両方を撮る**
2. **ファイル名に日付を含める**: `before-hero-20251222.png`
3. **保存先**: `screenshots/` ディレクトリ
4. **ドキュメントに埋め込む**: Markdown形式

### テンプレート

```markdown
### スクリーンショット

**Before**:
![旧デザイン](./screenshots/before-hero-20251222.png)
- 使用コンポーネント: FullscreenHero
- 特徴: ダーク基調

**After**:
![新デザイン](./screenshots/after-hero-20251222.png)
- 使用コンポーネント: OceanViewHero
- 特徴: Ocean & Sky カラーパレット、パララックス効果

**確認日時**: 2025-12-22 15:00 UTC
**確認環境**: ローカル開発サーバー（localhost:3000）
```

---

## 🔍 検証ルール

### 作業後の必須チェック

すべてのタスク完了後、以下を実行：

```bash
# 1. 自動検証スクリプト
bash scripts/verify-repository-state.sh

# 2. ビルドチェック
npm run build

# 3. ローカル確認
npm run dev
# ブラウザで http://localhost:3000 を開いて確認

# 4. コンポーネント使用状況確認
grep -r "from './components/modern" app/
grep -r "from './components/_legacy" app/
```

### 検証チェックリスト

- [ ] ビルドが成功する
- [ ] TypeScript エラーがない
- [ ] ESLint エラーがない
- [ ] ローカルでページが表示される
- [ ] 期待通りのデザインになっている
- [ ] スクリーンショットを撮影した
- [ ] ドキュメントを更新した

---

## 📝 コミットメッセージルール

### フォーマット

```
[種類]: 簡潔な説明（日本語）

- 変更内容の詳細1（日本語）
- 変更内容の詳細2（日本語）
- 関連する課題番号（あれば）
```

### 種類の一覧

- `fix:` - バグ修正
- `feat:` - 新機能追加
- `refactor:` - リファクタリング
- `docs:` - ドキュメント変更
- `style:` - スタイル変更（コードの動作に影響しない）
- `test:` - テスト追加・修正
- `chore:` - ビルド・ツール関連

### 例

**✅ 良い例**:
```
feat: ホームページのHeroをOceanViewHeroに置き換え

- app/page.tsx のインポートを変更
- FullscreenHero を OceanViewHero に置き換え
- ローカル確認完了、スクリーンショット添付
- 関連: UI_REDESIGN_URGENT.md Phase 2
```

**❌ 悪い例**:
```
update home page
```
→ 英語、内容が不明確

---

## 🚫 禁止事項（厳守）

### 絶対にやってはいけないこと

1. **❌ 動作確認なしでコミット**
   - 必ず `npm run dev` でブラウザ確認

2. **❌ スクリーンショットなしで「完了」**
   - 視覚的な変更には必ず証拠を添付

3. **❌ ドキュメントを先行させる**
   - 実装完了後にドキュメント更新

4. **❌ レガシーコンポーネントの削除**
   - Phase 2で順次移行するまで保持

5. **❌ 楽観的な進捗報告**
   - 実態ベースで報告

6. **❌ ビルドエラーを残したままコミット**
   - 必ず `npm run build` を実行

7. **❌ 英語でのコミットメッセージ**
   - 日本語で記載（プレフィックスは英語可）

---

## 🔄 Phase 2 開始条件

### Phase 2を開始してよい条件

以下のすべてが満たされた場合のみ、Phase 2を開始：

- [ ] リポジトリ整備が完了
- [ ] REPOSITORY_GUIDE.md が作成されている
- [ ] ドキュメントが整理されている（archive に移動済み）
- [ ] CURRENT_STATE.md が実態を反映している
- [ ] **「Phase 2を開始してください」と明示的な指示がある**

**重要**: 上記の条件が満たされていない場合、Phase 2は開始しない

---

## 📊 進捗報告ルール

### report_progress 使用時の注意

1. **実態ベースで報告**
   - 「完了」は本当に完了した場合のみ
   - 「進行中」は実際に作業中の場合のみ

2. **手戻りを隠さない**
   - 手戻りがある場合は明記
   - マイナスの進捗も正直に報告

3. **根拠を添付**
   - コミットハッシュ
   - スクリーンショット
   - 確認日時

### 進捗報告テンプレート

```markdown
## 進捗報告

### 完了したタスク
- [x] タスク名
  - コミット: a1b2c3d
  - スクリーンショット: ./screenshots/task-20251222.png
  - 確認日時: 2025-12-22 15:00 UTC

### 進行中のタスク
- [ ] タスク名
  - 進捗: 50%（レベル2まで完了、レベル3実施中）

### 手戻りタスク
- [ ] タスク名
  - 理由: ビルドエラーが発生したため再実装が必要
  - 影響: 1日の遅延
```

---

## 🎯 まとめ

### すべてのエージェントが守るべき5つのルール

1. **必読ドキュメントを読む**（START_HERE、CURRENT_STATE、REPOSITORY_GUIDE）
2. **タスク定義テンプレートを使う**（完了条件を明確に）
3. **4段階チェックリスト**（レベル3まで完了して「完了」）
4. **スクリーンショット必須**（視覚的な変更には証拠を）
5. **日本語で対応**（コミットメッセージ、レポート等）

### 困ったときは

1. `docs/REPOSITORY_GUIDE.md` を確認
2. このファイル（AGENT_RULES.md）を再読
3. 不明な場合は質問する（勝手に判断しない）

---

**ルール作成日**: 2025年12月22日  
**最終更新**: 2025年12月22日  
**次回更新**: ルール変更時
