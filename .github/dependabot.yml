version: 2
updates:
  # npm 依存関係の自動更新とセキュリティチェック
  - package-ecosystem: "npm"
    directory: "/"
    schedule:
      interval: "monthly"  # 週次 → 月次に変更してPR数をさらに削減
      day: "monday"
      time: "00:00"
      timezone: "Asia/Tokyo"
    # PRの最大数を大幅に削減
    open-pull-requests-limit: 3  # 5 → 3 に削減
    
    # 関連パッケージをグループ化してPR数を削減
    groups:
      # すべての依存関係を1つのPRにまとめる（最も積極的なグルーピング）
      all-dependencies:
        patterns:
          - "*"
        update-types:
          - "minor"
          - "patch"
      
      # セキュリティアップデートのみ別PR（優先度高）
      security-updates:
        patterns:
          - "*"
        update-types:
          - "security"
    
    # ラベル設定
    labels:
      - "dependencies"
      - "security"
    # コミットメッセージのプレフィックス
    commit-message:
      prefix: "chore(deps)"
      include: "scope"
    # バージョニング戦略
    versioning-strategy: "increase"
    # セキュリティアップデートのみを許可（メジャーバージョン更新は手動で行う）
    allow:
      - dependency-type: "direct"
        update-types: ["security"]
      - dependency-type: "production"
        update-types: ["security", "patch", "minor"]
    
  # GitHub Actions の自動更新（月次に変更）
  - package-ecosystem: "github-actions"
    directory: "/"
    schedule:
      interval: "monthly"
      day: "monday"
      time: "00:00"
      timezone: "Asia/Tokyo"
    open-pull-requests-limit: 1
    labels:
      - "dependencies"
      - "github-actions"
    commit-message:
      prefix: "chore(ci)"
